# Render Blueprint for the Socket.io backend
#
# Usage:
# - Push this repo to GitHub/GitLab
# - In Render, create a new Blueprint instance from the repo
# - Set/adjust env vars (especially CORS_ORIGINS) for your Vercel domain
services:
  - type: web
    name: deal-or-no-deal-backend
    env: node
    # Use Render's free plan by default to avoid requiring billing details during initial setup.
    # For best real-time stability (no sleeping), switch this to a paid plan later.
    plan: free
    rootDir: backend
    # NOTE: Render runs builds with NODE_ENV=production, which can omit devDependencies.
    # We need devDependencies during build for TypeScript + @types/*.
    buildCommand: npm ci --include=dev && npm run build
    startCommand: npm start
    healthCheckPath: /health
    autoDeploy: true
    envVars:
      - key: NODE_ENV
        value: production
      # IMPORTANT: Set this to your Vercel production domain (and optionally previews).
      # Examples:
      #   https://yourapp.vercel.app,https://yourdomain.com
      #   https://*.vercel.app,https://yourdomain.com
      - key: CORS_ORIGINS
        value: https://*.vercel.app
      # Optional: room cleanup configuration (ms)
      - key: ROOM_CLEANUP_INTERVAL_MS
        value: "600000"
      - key: ROOM_WAITING_TTL_MS
        value: "43200000"
      - key: ROOM_SELECTION_TTL_MS
        value: "43200000"
      - key: ROOM_FINISHED_TTL_MS
        value: "7200000"


